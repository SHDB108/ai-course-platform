<script setup lang="ts">
import { ContentWrap } from '@/components/ContentWrap'
import { ElCard, ElRow, ElCol, ElMessage } from 'element-plus'
import { ref, onMounted } from 'vue'

defineOptions({
  name: 'SystemAnalytics'
})

const loading = ref(false)
const systemStats = ref({
  totalUsers: 0,
  totalCourses: 0,
  totalTasks: 0,
  totalSubmissions: 0,
  activeUsers: 0,
  activeCourses: 0
})

const fetchSystemStats = async () => {
  loading.value = true
  try {
    // TODO: è°ƒç”¨ç³»ç»Ÿç»Ÿè®¡API
    // const res = await getSystemStatsApi()
    // if (res.data) {
    //   systemStats.value = res.data
    // }

    // æ¨¡æ‹Ÿæ•°æ®
    systemStats.value = {
      totalUsers: 1234,
      totalCourses: 89,
      totalTasks: 456,
      totalSubmissions: 3210,
      activeUsers: 987,
      activeCourses: 67
    }
  } catch (error) {
    ElMessage.error('è·å–ç³»ç»Ÿç»Ÿè®¡å¤±è´¥')
  } finally {
    loading.value = false
  }
}

onMounted(() => {
  fetchSystemStats()
})
</script>

<template>
  <ContentWrap>
    <div class="mb-20px">
      <h2 class="text-xl font-bold">ç³»ç»Ÿæ€»è§ˆ</h2>
      <p class="text-sm text-gray-500 mt-1">AIæ™ºæ…§è¯¾ç¨‹å¹³å°è¿è¥æ•°æ®ç»Ÿè®¡</p>
    </div>

    <ElRow :gutter="20">
      <ElCol :span="6">
        <ElCard shadow="hover" class="stat-card">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-blue-600">{{ systemStats.totalUsers }}</div>
              <div class="text-sm text-gray-600 mt-1">æ€»ç”¨æˆ·æ•°</div>
            </div>
            <div class="text-4xl text-blue-500"> ğŸ‘¥ </div>
          </div>
        </ElCard>
      </ElCol>

      <ElCol :span="6">
        <ElCard shadow="hover" class="stat-card">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-green-600">{{ systemStats.totalCourses }}</div>
              <div class="text-sm text-gray-600 mt-1">æ€»è¯¾ç¨‹æ•°</div>
            </div>
            <div class="text-4xl text-green-500"> ğŸ“š </div>
          </div>
        </ElCard>
      </ElCol>

      <ElCol :span="6">
        <ElCard shadow="hover" class="stat-card">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-orange-600">{{ systemStats.totalTasks }}</div>
              <div class="text-sm text-gray-600 mt-1">æ€»ä»»åŠ¡æ•°</div>
            </div>
            <div class="text-4xl text-orange-500"> ğŸ“ </div>
          </div>
        </ElCard>
      </ElCol>

      <ElCol :span="6">
        <ElCard shadow="hover" class="stat-card">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-purple-600">{{
                systemStats.totalSubmissions
              }}</div>
              <div class="text-sm text-gray-600 mt-1">æ€»æäº¤æ•°</div>
            </div>
            <div class="text-4xl text-purple-500"> ğŸ“¤ </div>
          </div>
        </ElCard>
      </ElCol>
    </ElRow>

    <ElRow :gutter="20" class="mt-20px">
      <ElCol :span="6">
        <ElCard shadow="hover" class="stat-card">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-red-600">{{ systemStats.activeUsers }}</div>
              <div class="text-sm text-gray-600 mt-1">æ´»è·ƒç”¨æˆ·</div>
            </div>
            <div class="text-4xl text-red-500"> ğŸ”¥ </div>
          </div>
        </ElCard>
      </ElCol>

      <ElCol :span="6">
        <ElCard shadow="hover" class="stat-card">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-cyan-600">{{ systemStats.activeCourses }}</div>
              <div class="text-sm text-gray-600 mt-1">æ´»è·ƒè¯¾ç¨‹</div>
            </div>
            <div class="text-4xl text-cyan-500"> â­ </div>
          </div>
        </ElCard>
      </ElCol>

      <ElCol :span="12">
        <ElCard shadow="hover" title="ç³»ç»Ÿå¥åº·çŠ¶æ€">
          <div class="text-center py-20">
            <div class="text-6xl mb-4">âœ…</div>
            <div class="text-xl font-semibold text-green-600">ç³»ç»Ÿè¿è¡Œæ­£å¸¸</div>
            <div class="text-sm text-gray-500 mt-2">æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œä¸­</div>
          </div>
        </ElCard>
      </ElCol>
    </ElRow>
  </ContentWrap>
</template>

<style scoped lang="less">
.stat-card {
  transition: transform 0.2s ease;
  cursor: pointer;

  &:hover {
    transform: translateY(-2px);
  }
}
</style>
